<!-- ./html/views/complete.html -->
<!-- Complete view: Completion stats, export options, and AI prompt generation -->

<section id="view-complete" class="view container" aria-labelledby="complete-title" tabindex="-1">
    <div class="complete-container">

        <!-- Header -->
        <header class="complete-header">
            <div class="complete-icon" aria-hidden="true">ğŸ’œ</div>
            <h1 id="complete-title" class="complete-title">Beautiful Work</h1>
            <p class="complete-subtitle">
                You've taken a meaningful step toward clarity. Your answers are safe hereâ€”yours to keep, share, or
                reflect on.
            </p>

            <!-- Global Stats -->
            <div id="complete-stats" aria-live="polite">
                <span id="complete-stats-text">Loading stats...</span>
            </div>
        </header>

        <!-- Import Review Warning (if applicable) -->
        <div id="import-review-warning" class="complete-card warning-card">
            <h2 class="card-title">âš ï¸ Some Answers Need Review</h2>
            <p class="card-description">
                <strong><span id="review-count">0</span> question(s)</strong> were partially imported and may need your
                attention.
                These questions have been flagged because the imported data didn't fully match the current questionnaire
                format.
            </p>
            <button id="btn-review-flagged" class="btn btn-warning btn-lg">
                ğŸ“‹ Review Flagged Questions
            </button>
        </div>

        <!-- Review Action - Moved to top -->
        <div class="complete-card review-card">
            <p class="card-description">Want to review what you wrote? Take a moment to reflect on your answers.</p>
            <button id="btn-review-answers" class="btn btn-primary btn-lg">
                ğŸ“‹ Review Your Answers
            </button>
        </div>

        <!-- What's Next Section -->
        <div class="complete-card next-steps-card">
            <h2 class="card-title">ğŸ’œ What's Next?</h2>
            <p class="card-description">
                Your answers are safely stored! Here's the simplest way to get AI insights:
            </p>

            <!-- Name Personalization -->
            <div class="name-field-container">
                <label for="complete-name-input" class="name-field-label">Your Name (for personalization)</label>
                <input type="text" id="complete-name-input" class="name-field-input" placeholder="Your first name"
                    autocomplete="given-name" />
                <p class="name-field-hint">This will personalize your AI prompt</p>
            </div>

            <!-- Clear Step-by-Step Guide -->
            <div class="next-steps-guide">
                <div class="next-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3 class="step-title">Copy Your Personalized AI Prompt</h3>
                        <p class="step-text">Click below to copy your customized prompt to the clipboard</p>
                        <button id="btn-copy-ai-prompt" class="btn btn-primary btn-lg">
                            âœ¨ Copy My AI Prompt
                        </button>
                        <button id="btn-view-raw-prompt" class="btn btn-secondary btn-sm">
                            ğŸ‘ View Raw Prompt
                        </button>
                    </div>
                </div>

                <div class="next-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3 class="step-title">Paste into ChatGPT, Claude, or Gemini</h3>
                        <p class="step-text">Open your favorite AI assistant and paste (Ctrl+V or Cmd+V)</p>
                    </div>
                </div>

                <div class="next-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3 class="step-title">Get Personalized Insights</h3>
                        <p class="step-text">The AI will analyze your responses and share meaningful reflections</p>
                    </div>
                </div>
            </div>

            <p class="help-link-container">
                <a href="#/howto" class="help-link">ğŸ“– Need help? View the step-by-step guide</a>
            </p>
        </div>

        <!-- Card 1: Save & Actions -->
        <div class="complete-card">
            <h2 class="card-title">ğŸ’¾ Save Your Answers</h2>
            <p class="card-description">Keep a copy of your responses to revisit later or continue where you left off.
            </p>

            <div class="action-row">
                <button id="btn-export-json" class="btn btn-primary">
                    ğŸ“ Save to Continue Later
                </button>
                <button id="btn-export-text" class="btn btn-secondary">
                    ğŸ“„ Save as Readable Text
                </button>
            </div>
            <p class="card-description card-tip">
                <strong>Tip:</strong> Save your file to import it later on the AI Analysis page or to share with your
                partner.
            </p>
        </div>

        <!-- Upgrade Section -->
        <div class="complete-card">
            <h2 class="card-title">ğŸ’‘ Couple's AI Reflection</h2>
            <p class="card-description">
                Ready to discuss? Generate a combined guide for both of you. Ensure you both completed the same
                questionnaire mode.
            </p>

            <div class="comparison-grid">
                <!-- Partner 1 (You) -->
                <div class="partner-column">
                    <span class="partner-label">Partner 1 (You)</span>
                    <div class="partner-name" id="p1-name">Me</div>
                    <div class="partner-stats-display" id="p1-stats">
                        <span id="p1-answered">--</span>/<span id="p1-total">--</span> Answered
                    </div>
                </div>

                <!-- Partner 2 (Upload) -->
                <div class="partner-column">
                    <span class="partner-label">Partner 2</span>

                    <!-- Upload Zone -->
                    <div id="upload-zone-partner" class="upload-zone mini-zone">
                        <input type="file" id="import-file-partner" accept=".json,.txt" hidden>

                        <!-- Empty State -->
                        <div class="upload-zone-content">
                            <div class="upload-icon">ğŸ“‚</div>
                            <div class="upload-text">
                                <span class="upload-link">Upload
                                    JSON</span>
                            </div>
                        </div>

                        <!-- Filled State -->
                        <div class="upload-zone-info">
                            <div class="upload-file-details">
                                <span class="upload-name">filename.json</span>
                                <button class="upload-remove" aria-label="Remove file">Ã—</button>
                            </div>

                            <!-- Editable Inputs -->
                            <div id="partner-info-container">
                                <input type="text" id="partner-name-input" class="text-input input-sm"
                                    placeholder="Name" value="Partner">
                                <div class="partner-stats-display">
                                    <span id="partner-stats-answered">--</span>/<span id="partner-stats-total">--</span>
                                    Answered
                                </div>
                                <div id="partner-warning" class="partner-warning">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Generate Action -->
            <button id="btn-generate-couple-prompt" class="btn btn-primary btn-full-width" disabled>
                âœ¨ Generate Combined Prompt & Copy
            </button>
        </div>

        <!-- Upgrade Section -->
        <div id="upgrade-section" class="complete-card">
            <h2 class="card-title">ğŸš€ Ready for More?</h2>
            <p class="card-description">
                You've completed the Lite version. Continue with <span id="additional-count">--</span> more questions to
                go deeper.
            </p>
            <button id="btn-upgrade-full" class="btn btn-primary">
                ğŸ“ˆ Continue to Full Mode
            </button>
        </div>


    </div>
</section>